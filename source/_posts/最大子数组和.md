---
title: 最大子数组和
categories:
- 算法
- 动态规划
tags:
- 算法
mathjax: true
---

### 最大子数组和（ 动态规划 | 线段树 ）

<!--more-->

> >给你一个整数数组 `nums` ，请你找出一个具有最大和的连续子数组（子数组最少包含一个元素），
> >
> >返回其最大和。**子数组** 是数组中的一个连续部分。
> >
> >```html
> >输入：nums = [-2,1,-3,4,-1,2,1,-5,4]
> >输出：6
> >解释：连续子数组 [4,-1,2,1] 的和最大，为 6 。
> >```

### 解法一：动态规划

假设数组长度为 `n` , 下标从 <em>0 ~ n - 1</em>,

不妨设 <em>f( i )</em> 表示以下标 <em>i</em> 结尾的连续子数组的最大和，那么所求答案即为：
$$
\max \limits_{0≤i≤n-1} \lbrace f(i) \rbrace
$$
那么可以得到转移方程：
$$
f(i) = max \lbrace f(i-1) + nums[i],nums[i] \rbrace
$$
代码如下：

```java
class Solution {
    public int maxSubArray(int[] nums) {
        int preSum = 0;
        int ans = nums[0];
        for(int i = 0; i < nums.length; i++) {
            preSum = Math.max(preSum + nums[i], nums[i]);
            ans = Math.max(preSum, ans);
        }
        return ans;
    }
}
```

$$
\begin{align}
&时间复杂度:O(n)
&空间复杂度:O(1)
\end{align}
$$

---

### 解法二：线段树






$$
\begin{align}
&时间复杂度:O(n)
&空间复杂度:O(logn)
\end{align}
$$

----

### 变式：环形子数组最大和

题目详情参考：[918. 环形子数组的最大和 - 力扣（LeetCode） (leetcode-cn.com)](https://leetcode-cn.com/problems/maximum-sum-circular-subarray/)

思路：

1. 首先按照子数组最大和的方式得到最大值；
2. 然后考虑环形数组的情况，即首尾一定被选取：
   1. 正向得到最大数组和；
   2. 反向得到最大数组和；
3. **但是不便于处理，因此求反面，按照子数组最大和的方式得到最小值；**
4. 求最小值时，数组的范围谨慎处理。

代码如下：

```java
class Solution {
    public int maxSubarraySumCircular(int[] nums) {
        int preSum = 0;
        int ansMax = Integer.MIN_VALUE;
        for (int i = 0; i < nums.length; i++) {
            preSum = Math.max(preSum + nums[i], nums[i]);
            ansMax = Math.max(preSum, ansMax);
        }

        if (nums.length <= 2) {
            return ansMax;
        }

        preSum = 0;
        int ansMin = Integer.MAX_VALUE;
        for (int i = 1; i < nums.length - 1; i++) {
            preSum = Math.min(preSum + nums[i], nums[i]);
            ansMin = Math.min(preSum, ansMin);
        }
        
        int sum = 0;
        for (int num : nums) {
            sum += num;
        }
        int ans = Math.max(ansMax, sum - ansMin);
        return ans;
    }
}
```

