---
title: 检测正方形
categories:
- 数据结构
- 哈希
tags:
- 数据结构
---

### 检测正方形

<!--more-->

> 题目详情参考：[2013. 检测正方形 - 力扣（LeetCode） (leetcode-cn.com)](https://leetcode-cn.com/problems/detect-squares/)

**题目的思路比较明确，但是处理的方法需要注意：哈希嵌套**

1. 将每个点按照纵坐标的值，存储在哈希表中
2. 在哈希表的基础上，将 `value` 值也使用哈希表存储
3. 当检测某个点时，只需查看相同纵坐标下，彼此点之间的距离
4. 点之间的距离即为待检测正方形的边长，随后分类讨论左右是否存在
5. 与此同时，需要注意点的个数，统计重复正方形

代码如下：

```java
class DetectSquares {
    Map<Integer, Map<Integer, Integer>> cnt;

    public DetectSquares() {
        cnt = new HashMap<Integer, Map<Integer, Integer>>();
    }

    public void add(int[] point) {
        int x = point[0], y = point[1];
        cnt.putIfAbsent(y, new HashMap<Integer, Integer>());
        Map<Integer, Integer> yCnt = cnt.get(y);
        yCnt.put(x, yCnt.getOrDefault(x, 0) + 1);
    }

    public int count(int[] point) {
        int res = 0;
        int x = point[0], y = point[1];
        if (!cnt.containsKey(y)) {
            return 0;
        }
        Map<Integer, Integer> yCnt = cnt.get(y);
        for (Map.Entry<Integer, Map<Integer, Integer>> entry : cnt.entrySet()) {
            int col = entry.getKey();
            Map<Integer, Integer> colCnt = entry.getValue();
            if (col != y) {
                // 根据对称性，这里可以不用取绝对值
                int d = col - y;
                res += colCnt.getOrDefault(x, 0) * 
                	   yCnt.getOrDefault(x + d, 0) * colCnt.getOrDefault(x + d, 0);
                res += colCnt.getOrDefault(x, 0) * 
                	   yCnt.getOrDefault(x - d, 0) * colCnt.getOrDefault(x - d, 0);
            }
        }
        return res;
    }
}
```

